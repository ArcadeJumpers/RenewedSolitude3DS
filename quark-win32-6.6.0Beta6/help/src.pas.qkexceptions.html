<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
  <title>QkExceptions.pas</title>
  <meta name="Description" content="QuArK Information Database - Page: 4.5.6.&nbsp;QkExceptions.pas">
  <meta name="Keywords" content="QuArK InfoBase Quake Army Knife QRK QKM Python PY Map Editor Hexen Heretic Half-Life Sin Kingpin Soldier-of-Fortune Star-Trek-Voyager Elite-Force">
  <link rel=stylesheet href="standard.css" type="text/css">
</head>

<body>
<a name="__top__"></a>
<table width="100%" border=0 cellspacing=0>
  <tr>
    <td width=213>
      <a target="_blank" href="http://quark.sourceforge.net/"><img src="quarkicon.png" width=213 height=90 border=0 alt="Go to QuArK Web Site"></a>
    </td>
    <td width="70%" align=center>
      <div class="topheadline">QkExceptions.pas</div>
      <div class="sm">Updated&nbsp;26 Sep 2010</div>
    </td>
    <td width="30%" valign=bottom nowrap>
      Upper&nbsp;levels:<br>-&nbsp;<a href="index.html">QuArK&nbsp;Information&nbsp;Base</a><br>-&nbsp;<a href="src.html">4.&nbsp;The&nbsp;Source&nbsp;Code</a><br>-&nbsp;<a href="src.pas.html">4.5.&nbsp;File-by-file&nbsp;descriptions</a><br>
    </td>
  </tr>
</table>
<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="99%">
      <p class="headline">&nbsp;4.5.6.&nbsp;QkExceptions.pas</p>
    </td>
    <td width="1%" align=right nowrap>
      &nbsp;[&nbsp;<span class="navenable"><a href="src.pas.qk1.html">Prev</a></span>&nbsp;-&nbsp;<span class="navenable"><a href="src.pas.html">Up</a></span>&nbsp;-&nbsp;<span class="navenable"><a href="src.pas.qkmap.html">Next</a></span>&nbsp;]&nbsp;
    </td>
  </tr>
</table>
<table border=0 width="100%" cellspacing=10><tr><td><p>This file contains several functions useful for exception handling.
</p>
</td></tr></table>
<br>

<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="100%">
      <p class="subheadline">&nbsp;Index</p>
    </td>
  </tr>
</table>
<ul class="index">
  <li>- <a href="#getexceptionmessage">GetExceptionMessage</a>&nbsp;<span class="added">(06 Sep 2008)</span>
  <li>- <a href="#logandwarn">LogAndWarn</a>&nbsp;<span class="added">(23 Sep 2008)</span>
  <li>- <a href="#logandraiseerror">LogAndRaiseError</a>&nbsp;<span class="added">(08 Oct 2008)</span>
  <li>- <a href="#eerror">EError</a>&nbsp;<span class="added">(06 Sep 2008)</span>
  <li>- <a href="#eerrorfmt">EErrorFmt</a>&nbsp;<span class="added">(06 Sep 2008)</span>
  <li>- <a href="#internale">InternalE</a>&nbsp;<span class="added">(23 Sep 2008)</span>
  <li>- <a href="#globalwarning">GlobalWarning</a>&nbsp;<span class="added">(12 Dec 2008)</span>
  <li>- <a href="#globaldisplaywarnings">GlobalDisplayWarnings</a>&nbsp;<span class="added">(12 Dec 2008)</span>
  <li>- <a href="#getsystemerrormessage">GetSystemErrorMessage</a>&nbsp;<span class="added">(08 Sep 2008)</span>
  <li>- <a href="#logwindowserror">LogWindowsError</a>&nbsp;<span class="added">(02 Apr 2010)</span>
</ul>
<br>


<a name="getexceptionmessage"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;GetExceptionMessage</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;06 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
function GetExceptionMessage(E: Exception) : String;
</pre></div>

<p>This function takes a generated exception, and strips the additional information from it and adds a point to the end (&nbsp;<tt>.</tt>&nbsp;).
</p><p>The additional information is everything after a double slash (&nbsp;<tt>//</tt>&nbsp;), and is used by the exception handler for the MORE panel.
</p><p>This function should be used instead of &nbsp;<tt>E.message</tt>&nbsp; whenever possible.
</p>
  </td></tr></table>
  <br>

<a name="logandwarn"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;LogAndWarn</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;23 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
procedure LogAndWarn(const WarnMessage : String);
</pre></div>

<p>Logs the error message given by &nbsp;<tt>ErrMessage</tt>&nbsp; to the log with LOG_WARNING priority, and then pops up a dialogbox with &nbsp;<tt>ErrMessage</tt>&nbsp; as the message.
</p><p>Note: This never raises any errors (by default...), so the code WILL return!
</p>
  </td></tr></table>
  <br>

<a name="logandraiseerror"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;LogAndRaiseError</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;08 Oct 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
procedure LogAndRaiseError(const ErrMessage : String);
</pre></div>

<p>Logs the error message given by &nbsp;<tt>ErrMessage</tt>&nbsp; to the log with LOG_CRITICAL priority, and then raises a Delphi exception with &nbsp;<tt>ErrMessage</tt>&nbsp; as the message.
</p><p>Note: Since this raises an error, the code will NOT return!
</p>
  </td></tr></table>
  <br>

<a name="eerror"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;EError</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;06 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
function EError(Res: Integer) : Exception;
</pre></div>

<p>This function takes the number of a string from the dictionary, and creates an exception with the resulting text as the message.
</p>
  </td></tr></table>
  <br>

<a name="eerrorfmt"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;EErrorFmt</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;06 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
function EErrorFmt(Res: Integer; Fmt: array of const) : Exception;
</pre></div>

<p>This function takes the number of a string from the dictionary, formats that string using the array of variables and values from the second parameter, and creates an exception with the resulting text as the message.
</p>
  </td></tr></table>
  <br>

<a name="internale"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;InternalE</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;23 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
function InternalE(const Hint: String) : Exception;
</pre></div>

<p>This function takes the hint and constructs a 'this program is buggy' message. Use this if the error can only happen if the program somehow managed to do something that *should* be impossible.
</p>
  </td></tr></table>
  <br>

<a name="globalwarning"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;GlobalWarning</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;12 Dec 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
procedure GlobalWarning(const Texte: String);
</pre></div>

<p>Adds &nbsp;<tt>Texte</tt>&nbsp; to the list of global warnings.
</p><p>Use this for instance during loading of a file, so all warnings can be displayed at once when loading has been completed.
</p>
  </td></tr></table>
  <br>

<a name="globaldisplaywarnings"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;GlobalDisplayWarnings</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;12 Dec 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
procedure GlobalDisplayWarnings;
</pre></div>

<p>Displays and clears all global warnings.
</p><p>This is called from AppIdle, so there (normally) is no need to call it yourself.
</p>
  </td></tr></table>
  <br>

<a name="getsystemerrormessage"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;GetSystemErrorMessage</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;08 Sep 2008</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
function GetSystemErrorMessage(ErrNr: DWORD) : String;
</pre></div>

<p>Retrieves the text associated with a Windows error number. This can be used in conjunction with &nbsp;<tt>GetLastError</tt>&nbsp; directly after a Windows exception has occured.
</p>
  </td></tr></table>
  <br>

<a name="logwindowserror"></a>
  <table width="100%" border=0 cellspacing=0>
    <tr class="headline">
      <td>
        <p class="item">&nbsp;LogWindowsError</p>
      </td>
      <td align=right>
        <font size=-2>DanielPharos&nbsp;-&nbsp;02 Apr 2010</font>
      </td>
      <td width="1%" align=right nowrap>
        &nbsp;&nbsp;[&nbsp;<a href="#__top__">Top</a>&nbsp;]&nbsp;
      </td>
    </tr>
  </table>
  <table border=0 width="100%" cellspacing=10><tr><td>
<div class="doccode"><pre>
procedure LogWindowsError(ErrNr: DWORD; const Call: String);
</pre></div>

<p>Use this if a Windows API fails. This procedure logs the error message given by &nbsp;<tt>GetSystemErrorMessage(ErrNr)</tt>&nbsp; to the log with LOG_WARNING priority, and blaims the &nbsp;<tt>Call</tt>&nbsp; function call for producing it.
</p><p>Note: This never raises any errors (by default...), so the code WILL return!
</p>
  </td></tr></table>
  <br>

<br>

<table width="100%" border=0 cellspacing=0>
  <tr class="headline">
    <td width="99%" align=center>
      <p class="sm">
        Copyright (c) 2009, GNU General Public License by The QuArK (Quake Army Knife) Community - <a target="_blank" href="http://quark.sourceforge.net/">http://quark.sourceforge.net/</a><br>
      </p>
    </td>
    <td width="1%" align=right nowrap>
      &nbsp;[&nbsp;<span class="navenable"><a href="src.pas.qk1.html">Prev</a></span>&nbsp;-&nbsp;<a href="#__top__">Top</a>&nbsp;-&nbsp;<span class="navenable"><a href="src.pas.qkmap.html">Next</a></span>&nbsp;]&nbsp;
    </td>
  </tr>
</table>
</body>
</html>